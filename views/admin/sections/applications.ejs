<!-- Recent Applications Section -->
<section id="section-applications" class="dashboard-section hidden">
    <div class="content-topbar mb-6">
        <div>
            <h2 class="text-2xl font-bold text-slate-900">Loan Applications</h2>
            <p class="text-sm text-slate-500">Manage and verify pending loan applications</p>
        </div>
        <div class="flex gap-2">
            <select id="applicationStatusFilter" class="px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="under_review">Under Review</option>
                <option value="approved">Approved</option>
                <option value="rejected">Rejected</option>
            </select>
        </div>
    </div>

    <div class="card table-elevated">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-bold">Recent Applications</h3>
            <button type="button" class="pill-indicator" data-action="refresh-applications" aria-label="Refresh applications">
                <i class="fas fa-history"></i> Live feed
            </button>
        </div>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>Application ID</th>
                        <th>Customer</th>
                        <th>Loan Amount</th>
                        <th>Status</th>
                        <th>Date</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="applicationsTable" data-section="applications-table">
                    <tr>
                        <td colspan="6" class="text-center text-gray-600 py-8">
                            <i class="fas fa-spinner fa-spin text-2xl"></i>
                            <p class="mt-2">Loading applications...</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>

<!-- Application Details Modal -->
<div id="applicationDetailModal" class="modal hidden">
    <div class="modal-overlay" data-action="close-modal"></div>
    <div class="modal-content max-w-4xl max-h-[90vh] overflow-y-auto">
        <div class="modal-header sticky top-0 bg-white border-b">
            <h2 class="text-2xl font-bold text-slate-900">Application Details</h2>
            <button data-action="close-modal" class="text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-2xl"></i>
            </button>
        </div>

        <div class="modal-body p-6 space-y-6">
            <!-- Application Status Card -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="card">
                    <div class="text-sm text-gray-600 mb-1">Application ID</div>
                    <div id="detailAppId" class="text-lg font-mono font-bold text-slate-900">-</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600 mb-1">Status</div>
                    <div id="detailStatus" class="inline-block px-3 py-1 rounded-full text-sm font-semibold bg-gray-100 text-gray-800">-</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600 mb-1">Application Date</div>
                    <div id="detailDate" class="text-lg font-bold text-slate-900">-</div>
                </div>
            </div>

            <!-- Customer Information -->
            <div class="card section-card">
                <h3 class="text-lg font-bold text-slate-900 mb-4 pb-3 border-b"><i class="fas fa-user mr-2 text-indigo-600"></i>Customer Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <div class="text-sm text-gray-600">Full Name</div>
                        <div id="detailCustomerName" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Email</div>
                        <div id="detailCustomerEmail" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Phone Number</div>
                        <div id="detailCustomerPhone" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">KYC Status</div>
                        <div id="detailKYCStatus" class="inline-block mt-1">
                            <span class="px-3 py-1 rounded-full text-sm font-semibold bg-yellow-100 text-yellow-800">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loan Details -->
            <div class="card section-card">
                <h3 class="text-lg font-bold text-slate-900 mb-4 pb-3 border-b"><i class="fas fa-file-contract mr-2 text-indigo-600"></i>Loan Details</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <div class="text-sm text-gray-600">Loan Product</div>
                        <div id="detailLoanProduct" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Loan Category</div>
                        <div id="detailLoanCategory" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Requested Amount</div>
                        <div id="detailLoanAmount" class="text-base font-bold text-green-600 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Tenure</div>
                        <div id="detailTenure" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Purpose</div>
                        <div id="detailPurpose" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Interest Rate</div>
                        <div id="detailInterestRate" class="text-base font-semibold text-slate-900 mt-1">-</div>
                    </div>
                </div>
            </div>

            <!-- Financial Calculations -->
            <div class="card section-card bg-gradient-to-br from-indigo-50 to-blue-50">
                <h3 class="text-lg font-bold text-slate-900 mb-4 pb-3 border-b"><i class="fas fa-calculator mr-2 text-indigo-600"></i>Financial Calculations</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-sm text-gray-600">Monthly EMI</div>
                        <div id="detailEMI" class="text-3xl font-bold text-indigo-600 mt-2">-</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-sm text-gray-600">Total Interest</div>
                        <div id="detailTotalInterest" class="text-3xl font-bold text-orange-600 mt-2">-</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-sm text-gray-600">Total Loan Amount</div>
                        <div id="detailTotalAmount" class="text-3xl font-bold text-green-600 mt-2">-</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-sm text-gray-600">Total EMIs</div>
                        <div id="detailTotalEMIs" class="text-3xl font-bold text-blue-600 mt-2">-</div>
                    </div>
                </div>
            </div>

            <!-- Uploaded Documents -->
            <div class="card section-card">
                <h3 class="text-lg font-bold text-slate-900 mb-4 pb-3 border-b"><i class="fas fa-file-upload mr-2 text-indigo-600"></i>Uploaded Documents</h3>
                <div id="detailDocuments" class="space-y-3">
                    <div class="text-gray-500 text-center py-6">No documents found</div>
                </div>
            </div>

            <!-- Admin Remarks -->
            <div class="card section-card">
                <h3 class="text-lg font-bold text-slate-900 mb-4 pb-3 border-b"><i class="fas fa-sticky-note mr-2 text-indigo-600"></i>Admin Remarks & Actions</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm text-gray-600 mb-2">Remarks</label>
                        <textarea id="adminRemarks" placeholder="Add remarks for this application..." class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none" rows="3"></textarea>
                    </div>
                    <div id="statusActionButtons" class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <button data-action="update-status" data-status="under_review" class="btn btn-secondary flex items-center justify-center gap-2">
                            <i class="fas fa-hourglass-half"></i> Mark Under Review
                        </button>
                        <button data-action="update-status" data-status="approved" class="btn btn-success flex items-center justify-center gap-2">
                            <i class="fas fa-check"></i> Approve
                        </button>
                        <button data-action="reject-application" class="btn btn-danger flex items-center justify-center gap-2">
                            <i class="fas fa-times"></i> Reject
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-footer sticky bottom-0 border-t bg-white p-4 flex justify-end gap-3">
            <button data-action="close-modal" class="btn btn-secondary">
                <i class="fas fa-times mr-2"></i> Close
            </button>
        </div>
    </div>
</div>

<style>
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1000;
        pointer-events: none;
    }

    .modal.hidden {
        display: none;
        pointer-events: none;
    }

    .modal:not(.hidden) {
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: auto;
    }

    .modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        cursor: pointer;
        pointer-events: auto;
    }

    .modal-content {
        position: relative;
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        z-index: 1001;
        display: flex;
        flex-direction: column;
        pointer-events: auto;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
    }

    .modal-body {
        flex: 1;
        overflow-y: auto;
    }

    .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
        padding: 1.5rem;
    }

    .section-card {
        border-left: 4px solid #4f46e5;
    }

    @media (max-width: 768px) {
        .modal-content {
            margin: 1rem;
            max-width: calc(100% - 2rem);
        }
    }
</style>
